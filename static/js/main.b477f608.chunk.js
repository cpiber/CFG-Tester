(this["webpackJsonpcfg-tester"]=this["webpackJsonpcfg-tester"]||[]).push([[0],{120:function(e,t,n){e.exports={strings:"GrammarOutput_strings__syveZ"}},125:function(e,t,n){},126:function(e,t,n){},146:function(e,t){},148:function(e,t){},158:function(e,t){},160:function(e,t){},187:function(e,t){},188:function(e,t){},193:function(e,t){},227:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),s=n(117),c=n.n(s),i=(n(125),n(126),n(0));var o,l,u=function(e){return Object(i.jsx)("header",{className:"".concat(e.className||""," App-header"),children:Object(i.jsxs)("h1",{children:[Object(i.jsx)("abbr",{title:"Context-free grammar",children:"CFG"})," Testing suite"]})})},h=n(19),b=n(5),f=n(65),m=n.n(f),d=n(118),v=Object(d.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=function(e){var t=m.a.parse(e);return{rules:"string"===typeof t.rules?t.rules:"",input:"string"===typeof t.input?t.input:""}},n=Object(a.useState)(t(e)),r=Object(b.a)(n,2),s=r[0],c=r[1],i=Object(a.useState)(void 0),o=Object(b.a)(i,2),l=o[0],u=o[1],f=Object(a.useCallback)((function(e){return c(Object(h.a)(Object(h.a)({},s),{},{rules:e}))}),[s,c]),d=Object(a.useCallback)((function(e){return c(Object(h.a)(Object(h.a)({},s),{},{input:e}))}),[s,c]),v=Object(a.useCallback)((function(e){return c(t(e))}),[c]);Object(a.useEffect)((function(){var e=function(){return v(window.location.hash)};return window.addEventListener("hashchange",e),function(){return window.removeEventListener("hashchange",e)}}),[v]);var j=Object(a.useRef)(0);return Object(a.useEffect)((function(){return j.current=window.setTimeout((function(){return window.location.hash=m.a.stringify(s)}),100),function(){return window.clearTimeout(j.current)}}),[s]),Object(a.useEffect)((function(){window.grammar=l}),[l]),Object(h.a)(Object(h.a)({},s),{},{setRules:f,setInput:d,grammar:l,setGrammar:u,updateQuery:v})})),j=n(38),p=n.n(j),O=n(13),y=n(11),g=n(14),x=n(66),w=n(16),k=n(29),N=n(28),T=n(26),S=n.n(T),E=n(17);o=Symbol.iterator,l=Symbol.toStringTag;var _=function(){function e(){Object(y.a)(this,e),this.map=new Map,this[o]=this.values,this[l]=void 0}return Object(g.a)(e,[{key:"size",get:function(){return this.map.size}},{key:"add",value:function(e){return this.map.set(e.hash(),e),this}},{key:"delete",value:function(e){return this.map.delete(e.hash())}},{key:"forEach",value:function(e,t){var n=this;this.map.forEach((function(t,a,r){return e(t,t,n)}),t)}},{key:"has",value:function(e){return this.map.has(e.hash())}},{key:"entries",value:function(){var e=this;return S.a.mark((function t(){var n,a,r,s;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Object(E.a)(e.map),t.prev=1,n.s();case 3:if((a=n.n()).done){t.next=9;break}return r=Object(b.a)(a.value,2),s=r[1],t.next=7,[s,s];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:return t.abrupt("return",void 0);case 18:case"end":return t.stop()}}),t,null,[[1,11,14,17]])}))()}},{key:"clear",value:function(){return this.map.clear()}},{key:"keys",value:function(){return this.map.values()}},{key:"values",value:function(){return this.map.values()}}]),e}();window.ComparableSet=_;var C=/(\\*)\|/g,I=/(\\(?:n|r|t|f))|\\(.)/g,R=function e(t){Object(y.a)(this,e),this.symbol=void 0,this.symbol=t},A=function(e){Object(k.a)(n,e);var t=Object(N.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"equals",value:function(e){return e instanceof n&&e.symbol===this.symbol}}]),n}(R),B=function(e){Object(k.a)(n,e);var t=Object(N.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"equals",value:function(e){return e instanceof n&&e.symbol===this.symbol}}]),n}(R),G=function(e){Object(k.a)(n,e);var t=Object(N.a)(n);function n(){return Object(y.a)(this,n),t.call(this,"")}return n}(B),F=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(y.a)(this,e),this.rule=void 0,this.before=void 0,this.depth=void 0,this.nonTerminals=void 0,this.rule=t,this.before=n,this.depth=a,this.nonTerminals=r},M=function(){function e(t,n,a,r,s){Object(y.a)(this,e),this.left=void 0,this.before=void 0,this.symbol=void 0,this.after=void 0,this.k=void 0,this.left=t,this.before=n,this.symbol=a,this.after=r,this.k=s}return Object(g.a)(e,[{key:"isFinished",value:function(){return void 0===this.symbol||this.symbol instanceof G}},{key:"isTerminal",value:function(){return this.symbol instanceof B}},{key:"isNonTerminal",value:function(){return this.symbol instanceof A}},{key:"hash",value:function(){var e,t=function(e,t){return e+t.symbol};return"".concat(this.left.symbol,"\u2192").concat(this.before.reduce(t,""),"\u2022").concat((null===(e=this.symbol)||void 0===e?void 0:e.symbol)||"").concat(this.after.reduce(t,""),",").concat(this.k)}}]),e}(),V=/^\s*([A-Z])\s*(?:->|\u2192)\s*(.*)$/,q=/(\\*)([A-Z])/g,z=function(e){Object(k.a)(n,e);var t=Object(N.a)(n);function n(e){var a;Object(y.a)(this,n),a=t.call(this);var r=e.split(/\r\n|\r|\n/g);for(var s in a.parseRules(r),a.rules)a.parseNonTerminals(a.rules[s]);return a}return Object(g.a)(n,[{key:"parseRules",value:function(e){for(var t=V,n=0;n<e.length;n++){var a=e[n];if(""!==a.trim()){var r=a.match(t);if(!r)throw new Error("Syntax error on line ".concat(n+1,": ").concat(this.lineToError(a)));for(var s=[],c=void 0,i=0;null!==(c=C.exec(r[2]));)if(c[1].length%2===0){var o=r[2].substring(i,c.index+c[1].length);s.push(this.branchToTerminal(o.trim())),i=C.lastIndex}var l=r[2].substring(i);s.push(this.branchToTerminal(l.trim()));var u,h=s.map((function(e){return[e]}));if(r[1]in this.rules)(u=this.rules[r[1]]).push.apply(u,Object(O.a)(h));else this.rules[r[1]]=h}}}},{key:"parseNonTerminals",value:function(e){for(var t=0;t<e.length;t++){for(var n=e[t][0].symbol,a=q,r=void 0,s=[],c=0;null!==(r=a.exec(n));)if(r[1].length%2===0&&r[2]in this.rules){var i=n.substring(c,r.index);""!==i&&s.push(this.branchToTerminal(i,!0)),s.push(new A(r[2])),c=a.lastIndex}var o=n.substring(c).trim();""!==o&&s.push(this.branchToTerminal(o,!0)),s.length||s.push(new G),e[t]=s}}},{key:"branchToTerminal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"^"===e||"\u03b5"===e||""===e?new G:new B(t?e.replace(I,"$1$2"):e)}},{key:"lineToError",value:function(e){return-1===e.indexOf("->")&&-1===e.indexOf("\u2192")?"Rule indicator '->' missing":"Non-terminal symbols must be single capital letters"}},{key:"clear",value:function(){this.initGenerator("S")}},{key:"checkValid",value:function(){if(Object(x.a)(Object(w.a)(n.prototype),"checkValid",this).call(this),!("S"in this.rules))throw new Error("Startsymbol 'S' not found")}},{key:"matches",value:function(e){return Object(x.a)(Object(w.a)(n.prototype),"match",this).call(this,e,"S")}}]),n}(function(){function e(){Object(y.a)(this,e),this.gen=void 0,this.maxDepth=+(window.localStorage.getItem("cfg_maxdepth")||20),this.maxNonTerms=+(window.localStorage.getItem("cfg_maxnonterm")||10),this.maxIter=+(window.localStorage.getItem("cfg_iter")||5e3),this.rules={}}return Object(g.a)(e,[{key:"next",value:function(){if(!this.gen)throw new Error("Attempted to call .next without a generator, this should never happen!");return this.gen.next().value}},{key:"checkValid",value:function(){for(var e in this.rules){var t=this.rules[e];if(0===t.length)throw new Error("Empty ruleset, this should never happen!");var n,a=Object(E.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(0===r.length)throw new Error("Empty rule, this should never happen!");if(1===r.length&&""===r[0].symbol&&!(r[0]instanceof G))throw new Error("Empty symbol that isn't an EmptySymbol, this should never happen!");if(r.length>1&&-1!==r.findIndex((function(e){return e instanceof G})))throw new Error("EmptySymbol found in a longer rule, this should never happen!")}}catch(s){a.e(s)}finally{a.f()}}}},{key:"initGenerator",value:function(e){var t=S.a.mark(r),n=this,a=0;function r(e){var r,s,c,i,o,l,u;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.shift())){t.next=18;break}if(a++,s=n.expandTerminal(r),i=(c=r).rule,o=c.before,l=c.depth,u=c.nonTerminals,void 0!==s){t.next=9;break}return t.next=7,o;case 7:return a=0,t.abrupt("continue",0);case 9:if(!(a>=n.maxIter)){t.next=13;break}return t.next=12,new Error("Iterated ".concat(a," times without finding a new value"));case 12:a=0;case 13:if(!(l>n.maxDepth||u>n.maxNonTerms)){t.next=15;break}return t.abrupt("continue",0);case 15:n.expandNonTerminal(s,i,e,r),t.next=0;break;case 18:return t.abrupt("return",void 0);case 19:case"end":return t.stop()}}),t)}this.gen=r([new F([new A(e)])])}},{key:"expandTerminal",value:function(e){for(var t=e.rule,n=t.shift();n instanceof B;)e.before+=n.symbol,n=t.shift(),e.nonTerminals=0;return n}},{key:"expandNonTerminal",value:function(e,t,n,a){var r,s=a.before,c=a.depth,i=a.nonTerminals,o=this.rules[e.symbol],l=Object(E.a)(o);try{for(l.s();!(r=l.n()).done;){var u=r.value;n.push(new F([].concat(Object(O.a)(u),Object(O.a)(t)),s,c+1,i+1))}}catch(h){l.e(h)}finally{l.f()}}},{key:"match",value:function(e,t){var n=[];n.push(new _);var a=new M(new A(""),[],new A(t),[],0),r=new M(new A(""),[new A(t)],void 0,[],0);n[0].add(a);for(var s=0;s<=e.length;s++){n.push(new _);var c,i=Object(E.a)(n[s]);try{for(i.s();!(c=i.n()).done;){var o=c.value;if(o.isFinished())this.completer(o,s,n);else if(o.isNonTerminal())this.predictor(o,s,n);else{if(!o.isTerminal())throw new Error("Unknown symbol type, this should never happen!");this.scanner(o,s,n,e)}}}catch(l){i.e(l)}finally{i.f()}}return n[e.length].has(r)}},{key:"completer",value:function(e,t,n){var a,r=Object(E.a)(n[e.k]);try{for(r.s();!(a=r.n()).done;){var s=a.value;if(!s.isFinished()){var c=s;c.symbol.equals(e.left)&&this.nextInRule(c,t,n)}}}catch(i){r.e(i)}finally{r.f()}}},{key:"predictor",value:function(e,t,n){var a,r=Object(E.a)(this.rules[e.symbol.symbol]);try{for(r.s();!(a=r.n()).done;){var s=a.value;n[t].add(new M(e.symbol,[],s[0],s.slice(1),t))}}catch(c){r.e(c)}finally{r.f()}}},{key:"scanner",value:function(e,t,n,a){t!==a.length&&a[t]===e.symbol.symbol[0]&&(e.symbol.symbol.length>1?n[t+1].add(new M(e.left,[].concat(Object(O.a)(e.before),[new B(e.symbol.symbol[0])]),new B(e.symbol.symbol.slice(1)),Object(O.a)(e.after),e.k)):this.nextInRule(e,t+1,n))}},{key:"nextInRule",value:function(e,t,n){var a=e.after.length>=1?e.after[0]:void 0,r=e.after.length>=1?e.after.slice(1):[];n[t].add(new M(e.left,[].concat(Object(O.a)(e.before),[e.symbol]),a,r,e.k))}}]),e}()),P=n(25),$=n.n(P),D=n(119),Z=n.n(D),J=n(27),L=n.n(J),Q=function(e){var t=e.id||Z()();return Object(i.jsxs)("div",{className:"".concat(L.a.area," ").concat(e.className||""),children:[e.title&&Object(i.jsx)("h2",{className:L.a.title,children:Object(i.jsx)("label",{htmlFor:t,children:e.title})}),Object(i.jsx)("textarea",{id:t,className:"textarea monospace",onChange:e.onChange,draggable:"false",placeholder:e.placeholder?e.placeholder:"Enter text here...",value:e.value,"aria-label":e.aria}),e.children&&Object(i.jsx)("div",{className:"children",children:e.children})]})},U=function(e){var t=v.useContainer(),n=t.rules,r=t.setRules,s=t.setGrammar,c=Object(a.useState)(["",""]),o=Object(b.a)(c,2),l=o[0],u=o[1],h=Object(a.useRef)(0),f=Object(a.useCallback)((function(){return h.current=window.setTimeout((function(){try{s(new z(n)),u(["ok",""])}catch(e){u(["error","".concat(e)])}}),50),function(){return window.clearTimeout(h.current)}}),[n,s]);return Object(a.useEffect)(f,[n,f]),Object(i.jsx)("div",{className:"".concat(e.className||""," status-").concat(l[0]," App-bodyComponent"),children:Object(i.jsxs)(Q,{className:$.a.textarea,value:n,onChange:function(e){r(e.target.value)},title:"Rules",aria:"Rules that describe the grammar",children:[Object(i.jsx)("div",{className:"row1",children:Object(i.jsx)("div",{className:"status",children:l[1]})}),Object(i.jsx)("div",{className:"row2",children:Object(i.jsx)("button",{className:"button secondary",onClick:function(e){e.target.blur(),f()},children:"Regenerate Model"})})]})})},W=function(e){var t=v.useContainer(),n=t.input,r=t.setInput,s=t.grammar,c=Object(a.useState)(["",""]),o=Object(b.a)(c,2),l=o[0],u=o[1],h=Object(a.useState)(!1),f=Object(b.a)(h,2),m=f[0],d=f[1],j=Object(a.useRef)(0),p=Object(a.useCallback)((function(){try{if(!s)throw new Error("No grammar object available");s.checkValid();var e=s.matches(n);d(!1),u([e?"ok":"error","Input ".concat(e?"matches":"doesn't match")])}catch(t){d(!0),u(["error","".concat(t)])}}),[n,s]);return Object(a.useEffect)((function(){return j.current=window.setTimeout(p,100),function(){return window.clearTimeout(j.current)}}),[p]),Object(i.jsx)("div",{className:"".concat(e.className||""," status-").concat(l[0]," App-bodyComponent"),children:Object(i.jsxs)(Q,{className:$.a.textarea,value:n,onChange:function(e){return r(e.target.value)},title:"Test Input",aria:"Input to match with grammar",children:[Object(i.jsx)("div",{className:"row1",children:Object(i.jsx)("span",{className:"status",children:l[1]})}),Object(i.jsx)("div",{className:"row2",children:Object(i.jsx)("button",{className:"button secondary",onClick:function(e){e.target.blur(),p()},disabled:m,children:"Re-Match"})})]})})},K=function(e,t,n){return Math.min(Math.max(e,t),n)},Y=n(120),H=n.n(Y),X="cfg_gen_number",ee=K(+(window.localStorage.getItem(X)||15),1,999),te=function(e){var t=v.useContainer().grammar,n=Object(a.useState)(new Set),r=Object(b.a)(n,2),s=r[0],c=r[1],o=Object(a.useState)(!1),l=Object(b.a)(o,2),u=l[0],h=l[1],f=Object(a.useState)(ee),m=Object(b.a)(f,2),d=m[0],j=m[1],p=Object(a.useState)(["",""]),y=Object(b.a)(p,2),g=y[0],x=y[1],w=function(){c(new Set);try{null===t||void 0===t||t.checkValid(),null===t||void 0===t||t.clear(),h(!1),x(["",""])}catch(e){h(!0),x(["error","".concat(e)])}};Object(a.useEffect)(w,[t]);var k=Object(a.useMemo)((function(){return Object(O.a)(s.values()).map((function(e,t){return Object(i.jsx)("li",{className:"monospace",children:e.toString().split(/\r\n|\r|\n|\\n/g).map((function(e,t){return Object(i.jsx)("span",{children:e},t)}))},t)}))}),[s]);return Object(i.jsx)("div",{className:"".concat(e.className||""," status-").concat(g[0]," App-bodyComponent"),children:Object(i.jsxs)("div",{className:"".concat(L.a.area," ").concat($.a.textarea),children:[Object(i.jsx)("h2",{className:L.a.title,children:"Strings"}),Object(i.jsx)("div",{className:H.a.strings,children:Object(i.jsx)("ul",{children:k})}),Object(i.jsxs)("div",{className:"children",children:[Object(i.jsx)("div",{className:"row1",children:Object(i.jsx)("span",{className:"status",children:g[1]})}),Object(i.jsxs)("div",{className:"row2",children:[Object(i.jsxs)("button",{className:"button secondary",onClick:function(e){if(function(e,t){if(!e.target)return!1;var n=e.target;return"INPUT"!==n.tagName&&(n.blur(),!!t)}(e,t)){h(!0),x(["",""]);var n,a=!1;for(n=0;n<d;n++){var r=t.next();if(void 0===r)break;if(r instanceof Error){a=!0,x(["warn",r.message]);break}s.add(r)}c(new Set(s)),n<d&&!a?x(["info","Grammmar exhausted"]):h(!1)}},disabled:u,"aria-label":"Get more strings",children:["Get ",Object(i.jsx)("input",{type:"number",className:"input secondary_alt",size:3,value:d,onChange:function(e){var t=K(+e.target.value,1,999);j(t),window.localStorage.setItem(X,t.toString())},"aria-label":"Number of strings to get"})," more"]}),Object(i.jsx)("button",{className:"button secondary",onClick:function(e){e.target&&(e.target.blur(),w())},"aria-label":"Clear strings",children:"Clear"})]})]})]})})},ne=function(e){return Object(i.jsx)("div",{className:"".concat(e.className||""," ").concat(p.a.grid," App-body"),children:Object(i.jsxs)(v.Provider,{initialState:window.location.hash,children:[Object(i.jsx)(U,{className:p.a.left}),Object(i.jsx)(W,{className:p.a.rightTop}),Object(i.jsx)(te,{className:p.a.rightBottom})]})})};var ae=function(e){var t=(new Date).getFullYear().toString(),n="2020",a="Constantin Piber",s="https://github.com/cpiber/cfg-tester";return Object(i.jsxs)("footer",{className:"".concat(e.className||""," App-footer"),children:[t===n?t:"".concat(n,"-").concat(t)," by ".concat(a),Object(i.jsxs)(r.a.Fragment,{children:[Object(i.jsx)("span",{children:" :: "}),Object(i.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:"Source"})]})]})};var re=function(){return Object(i.jsxs)("div",{className:"App",children:[Object(i.jsx)(u,{}),Object(i.jsx)(ne,{}),Object(i.jsx)(ae,{})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(i.jsx)(re,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},25:function(e,t,n){e.exports={textarea:"bodyComponent_textarea__2AEVB"}},27:function(e,t,n){e.exports={area:"textarea_area__1mQmu",title:"textarea_title__3f-Ka"}},38:function(e,t,n){e.exports={grid:"Body_grid__2Eze4",left:"Body_left__3afN_",rightTop:"Body_rightTop__x95CP",rightBottom:"Body_rightBottom__2q8gj"}}},[[227,1,2]]]);
//# sourceMappingURL=main.b477f608.chunk.js.map