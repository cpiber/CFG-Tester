(this["webpackJsonpcfg-tester"]=this["webpackJsonpcfg-tester"]||[]).push([[0],{126:function(e,t,n){},146:function(e,t){},148:function(e,t){},158:function(e,t){},160:function(e,t){},187:function(e,t){},188:function(e,t){},193:function(e,t){},227:function(e,t,n){},228:function(e,t,n){"use strict";n.r(t);var a,r,i=n(2),s=n.n(i),c=n(119),o=n.n(c),l=(n(126),n(19)),u=n(5),h=n(67),b=n.n(h),f=n(120),m=Object(f.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=function(e){var t=b.a.parse(e);return{rules:"string"===typeof t.rules?t.rules:"",input:"string"===typeof t.input?t.input:""}},n=Object(i.useState)(t(e)),a=Object(u.a)(n,2),r=a[0],s=a[1],c=Object(i.useState)(void 0),o=Object(u.a)(c,2),h=o[0],f=o[1],m=Object(i.useCallback)((function(e){return s(Object(l.a)(Object(l.a)({},r),{},{rules:e}))}),[r,s]),d=Object(i.useCallback)((function(e){return s(Object(l.a)(Object(l.a)({},r),{},{input:e}))}),[r,s]),v=Object(i.useCallback)((function(e){return s(t(e))}),[s]);Object(i.useEffect)((function(){var e=function(){return v(window.location.hash)};return window.addEventListener("hashchange",e),function(){return window.removeEventListener("hashchange",e)}}),[v]);var j=Object(i.useRef)(0);return Object(i.useEffect)((function(){return j.current=window.setTimeout((function(){return window.location.hash=b.a.stringify(r)}),100),function(){return window.clearTimeout(j.current)}}),[r]),Object(i.useEffect)((function(){window.grammar=h}),[h]),Object(l.a)(Object(l.a)({},r),{},{setRules:m,setInput:d,grammar:h,setGrammar:f,updateQuery:v})})),d=n(38),v=n.n(d),j=n(15),p=function(e,t,n){return Math.min(Math.max(e,t),n)},g=n(25),y=n.n(g),O=n(68),x=n.n(O),w=n(26),k=n.n(w),N=n(0),T="cfg_gen_number",S=p(+(window.localStorage.getItem(T)||15),1,999),_=function(e){var t=e.className,n=m.useContainer().grammar,a=Object(i.useState)(new Set),r=Object(u.a)(a,2),s=r[0],c=r[1],o=Object(i.useState)(!1),l=Object(u.a)(o,2),h=l[0],b=l[1],f=Object(i.useState)(S),d=Object(u.a)(f,2),v=d[0],g=d[1],O=Object(i.useState)(["",""]),w=Object(u.a)(O,2),_=w[0],E=w[1],C=function(){c(new Set);try{null===n||void 0===n||n.checkValid(),null===n||void 0===n||n.clear(),b(!1),E(["",""])}catch(e){b(!0),E(["error","".concat(e)])}};Object(i.useEffect)(C,[n]);var I=Object(i.useMemo)((function(){return Object(j.a)(s.values()).map((function(e,t){return Object(N.jsx)("li",{className:"monospace",children:e.split(/\r\n|\r|\n|\\n/g).map((function(e,t){return Object(N.jsx)("span",{className:""===e?x.a.empty:"",children:e||"\u03b5"},t)}))},t)}))}),[s]);return Object(N.jsx)("div",{className:"".concat(t||""," status-").concat(_[0]," App-bodyComponent"),children:Object(N.jsxs)("div",{className:"".concat(k.a.area," ").concat(y.a.textarea),children:[Object(N.jsx)("h2",{className:k.a.title,children:"Strings"}),Object(N.jsx)("div",{className:x.a.strings,children:Object(N.jsx)("ul",{children:I})}),Object(N.jsxs)("div",{className:"children",children:[Object(N.jsx)("div",{className:"row1",children:Object(N.jsx)("span",{className:"status",children:_[1]})}),Object(N.jsxs)("div",{className:"row2",children:[Object(N.jsxs)("button",{className:"button secondary",onClick:function(e){if(function(e,t){if(!e.target)return!1;var n=e.target;return"INPUT"!==n.tagName&&(n.blur(),!!t)}(e,n)){b(!0),E(["",""]);var t,a=!1;for(t=0;t<v;t++){var r=n.next();if(void 0===r)break;if(r instanceof Error){a=!0,E(["warn",r.message]);break}s.add(r)}c(new Set(s)),t<v&&!a?E(["info","Grammar exhausted"]):b(!1)}},disabled:h,"aria-label":"Get more strings",children:["Get ",Object(N.jsx)("input",{type:"number",className:"input secondary_alt",size:3,value:v,onChange:function(e){var t=p(+e.target.value,1,999);g(t),window.localStorage.setItem(T,t.toString())},"aria-label":"Number of strings to get"})," more"]}),Object(N.jsx)("button",{className:"button secondary",onClick:function(e){e.target&&(e.target.blur(),C())},"aria-label":"Clear strings",children:"Clear"})]})]})]})})},E=n(11),C=n(13),I=n(44),R=n(29),B=n(28),A=n(45),G=n(14),F=n(27),M=n.n(F),V=n(17);a=Symbol.iterator,r=Symbol.toStringTag;var $=function(){function e(t){Object(E.a)(this,e),this.map=void 0,this.clear=void 0,this.keys=void 0,this.values=void 0,this[a]=void 0,this.map=t?new Map(t.map):new Map,this.clear=this.map.clear.bind(this.map),this.keys=this.map.values.bind(this.map),this.values=this.map.values.bind(this.map),this[Symbol.iterator]=this.values}return Object(C.a)(e,[{key:"size",get:function(){return this.map.size}},{key:"add",value:function(e){return this.map.set(e.hash(),e),this}},{key:"delete",value:function(e){return this.map.delete(e.hash())}},{key:"forEach",value:function(e,t){var n=this;this.map.forEach((function(a,r,i){return e.call(t,a,a,n)}),t)}},{key:"has",value:function(e){return this.map.has(e.hash())}},{key:"entries",value:function(){var e=this;return M.a.mark((function t(){var n,a,r,i;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Object(V.a)(e.map),t.prev=1,n.s();case 3:if((a=n.n()).done){t.next=9;break}return r=Object(u.a)(a.value,2),i=r[1],t.next=7,[i,i];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:return t.abrupt("return",void 0);case 18:case"end":return t.stop()}}),t,null,[[1,11,14,17]])}))()}},{key:r,get:function(){return"ComparableSet"}}]),e}(),q=/(\\*)\|/g,z=/(\\(?:n|r|t|f))|\\(.)/g,P=/(^|[^\\])(\\\\)*\\$/g,D=function e(t){Object(E.a)(this,e),this.symbol=void 0,this.symbol=t},L=function(e){Object(R.a)(n,e);var t=Object(B.a)(n);function n(){return Object(E.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"equals",value:function(e){return e instanceof n&&e.symbol===this.symbol}},{key:Symbol.toStringTag,get:function(){return"NonTerminal"}}]),n}(D),Z=function(e){Object(R.a)(n,e);var t=Object(B.a)(n);function n(){return Object(E.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"equals",value:function(e){return e instanceof n&&e.symbol===this.symbol}},{key:Symbol.toStringTag,get:function(){return"Terminal"}}]),n}(D),J=function(e){Object(R.a)(n,e);var t=Object(B.a)(n);function n(){return Object(E.a)(this,n),t.call(this,"")}return Object(C.a)(n,[{key:Symbol.toStringTag,get:function(){return"EmptySymbol"}}]),n}(Z),Q=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(E.a)(this,e),this.rule=void 0,this.before=void 0,this.depth=void 0,this.nonTerminals=void 0,this.rule=t,this.before=n,this.depth=a,this.nonTerminals=r},U=function(){function e(t,n,a,r,i){Object(E.a)(this,e),this.left=void 0,this.before=void 0,this.symbol=void 0,this.after=void 0,this.origin=void 0,this.left=t,this.before=n,this.symbol=a,this.after=r,this.origin=i}return Object(C.a)(e,[{key:"isFinished",value:function(){return void 0===this.symbol||this.symbol instanceof J}},{key:"isTerminal",value:function(){return this.symbol instanceof Z}},{key:"isNonTerminal",value:function(){return this.symbol instanceof L}},{key:"hash",value:function(){var e=function(e){return e instanceof L?"\x01".concat(e.symbol,"\x01"):(null===e||void 0===e?void 0:e.symbol)||""},t=function(t,n){return t+e(n)};return"".concat(this.left.symbol,"\u2192").concat(this.before.reduce(t,""),"\x02\u2022").concat(e(this.symbol)).concat(this.after.reduce(t,""),"\x03,").concat(this.origin)}}]),e}(),W=/^\s*([A-Z])\s*(?:->|\u2192)\s*((?:.|\n)*)$/m,Y=/(\\*)([A-Z])/g,K=function(e){Object(R.a)(n,e);var t=Object(B.a)(n);function n(e){var a,r;Object(E.a)(this,n),r=t.call(this);var i=Object(A.a)((a=Object(I.a)(r),Object(G.a)(n.prototype)),"prepareRules",a).call(a,e);for(var s in r.parseRules(i),r.rules)r.parseNonTerminals(r.rules[s]);return r}return Object(C.a)(n,[{key:"parseRules",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null!==n){var a=n.match(W);if(!a)throw new Error("Syntax error on line ".concat(t+1,": ").concat(this.lineToError(n)));var r,i=this.toBranches(a[2],this.branchToTerminal).map((function(e){return[e]}));if(a[1]in this.rules)(r=this.rules[a[1]]).push.apply(r,Object(j.a)(i));else this.rules[a[1]]=i}}}},{key:"parseNonTerminals",value:function(e){for(var t=0;t<e.length;t++){for(var n=e[t][0].symbol,a=void 0,r=[],i=0;null!==(a=Y.exec(n));)if(a[1].length%2===0&&a[2]in this.rules){var s=n.substring(i,a.index);""!==s&&r.push(this.branchToTerminal(s,!0)),r.push(new L(a[2])),i=Y.lastIndex}var c=n.substring(i);""!==c&&r.push(this.branchToTerminal(c,!0)),r.length||r.push(new J),e[t]=r}}},{key:"branchToTerminal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"^"===e||"\u03b5"===e||""===e?new J:new Z(t?e.replace(z,"$1$2"):e)}},{key:"lineToError",value:function(e){return console.error("Error on line:",e),-1===e.indexOf("->")&&-1===e.indexOf("\u2192")?"Rule indicator '->' missing":"Non-terminal symbols must be single capital letters"}},{key:"clear",value:function(){this.initGenerator("S")}},{key:"checkValid",value:function(){if(Object(A.a)(Object(G.a)(n.prototype),"checkValid",this).call(this),!("S"in this.rules))throw new Error("Startsymbol 'S' not found")}},{key:"matches",value:function(e){return Object(A.a)(Object(G.a)(n.prototype),"match",this).call(this,e,"S")}}]),n}(function(){function e(){Object(E.a)(this,e),this.gen=void 0,this.maxDepth=+(window.localStorage.getItem("cfg_maxdepth")||20),this.maxNonTerms=+(window.localStorage.getItem("cfg_maxnonterm")||10),this.maxIter=+(window.localStorage.getItem("cfg_iter")||5e3),this.rules={}}return Object(C.a)(e,[{key:"next",value:function(){if(!this.gen)throw new Error("Attempted to call .next without a generator, this should never happen!");return this.gen.next().value}},{key:"checkValid",value:function(){for(var e in this.rules){var t,n=this.rules[e],a=Object(V.a)(n);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(0===r.length)throw new Error("Empty rule, this should never happen!");if(1===r.length&&""===r[0].symbol&&!(r[0]instanceof J))throw new Error("Empty symbol that isn't an EmptySymbol, this should never happen!");if(r.length>1&&-1!==r.findIndex((function(e){return e instanceof J||0===e.symbol.length})))throw new Error("EmptySymbol found in a longer rule, this should never happen!")}}catch(i){a.e(i)}finally{a.f()}}}},{key:"prepareRules",value:function(e){return e.split(/\r\n|\r|\n/g).map((function(e,t,n){var a=e.trim().replace(/[\u0000-\u001f\u007f-\u009F]/g,"");if(""===a)return null;if(a.match(P)){if(t+1===n.length)return a.slice(0,a.length-1);var r=a.slice(0,a.length-1)+n[t+1].trim();return n[t+1]="",r}return a}))}},{key:"toBranches",value:function(e,t){for(var n,a=function(e){return e.trim().replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\f/g,"\f")},r=[],i=0;null!==(n=q.exec(e));)if(n[1].length%2===0){var s=e.substring(i,n.index+n[1].length);r.push(t(a(s))),i=q.lastIndex}var c=e.substring(i);return r.push(t(a(c))),r}},{key:"initGenerator",value:function(e){var t=M.a.mark(r),n=this,a=0;function r(e){var r,i,s,c,o,l,u;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.shift())){t.next=18;break}if(a++,i=n.expandTerminal(r),c=(s=r).rule,o=s.before,l=s.depth,u=s.nonTerminals,void 0!==i){t.next=9;break}return t.next=7,o;case 7:return a=0,t.abrupt("continue",0);case 9:if(!(a>=n.maxIter)){t.next=13;break}return t.next=12,new Error("Iterated ".concat(a," times without finding a new value"));case 12:a=0;case 13:if(!(l>n.maxDepth||u>n.maxNonTerms)){t.next=15;break}return t.abrupt("continue",0);case 15:n.expandNonTerminal(i,c,e,r),t.next=0;break;case 18:return t.abrupt("return",void 0);case 19:case"end":return t.stop()}}),t)}this.gen=r([new Q([new L(e)])])}},{key:"expandTerminal",value:function(e){for(var t=e.rule,n=t.shift();n instanceof Z;)e.before+=n.symbol,n=t.shift(),e.nonTerminals=0;return n}},{key:"expandNonTerminal",value:function(e,t,n,a){var r,i=a.before,s=a.depth,c=a.nonTerminals,o=this.rules[e.symbol],l=Object(V.a)(o);try{for(l.s();!(r=l.n()).done;){var u=r.value;n.push(new Q([].concat(Object(j.a)(u),Object(j.a)(t)),i,s+1,c+1))}}catch(h){l.e(h)}finally{l.f()}}},{key:"match",value:function(e,t){var n=[];n.push(new $);var a=new U(new L(""),[],new L(t),[],0),r=new U(new L(""),[new L(t)],void 0,[],0);n[0].add(a);for(var i=0;i<=e.length;i++){n.push(new $);var s,c=Object(V.a)(n[i]);try{for(c.s();!(s=c.n()).done;){var o=s.value;if(o.isFinished())this.completer(o,i,n);else if(o.isNonTerminal())this.predictor(o,i,n);else{if(!o.isTerminal())throw new Error("Unknown symbol type, this should never happen!");this.scanner(o,i,n,e)}}}catch(l){c.e(l)}finally{c.f()}}return n[e.length].has(r)}},{key:"completer",value:function(e,t,n){var a,r=Object(V.a)(n[e.origin]);try{for(r.s();!(a=r.n()).done;){var i=a.value;if(!i.isFinished()){var s=i;s.symbol.equals(e.left)&&this.nextInRule(s,t,n)}}}catch(c){r.e(c)}finally{r.f()}}},{key:"predictor",value:function(e,t,n){var a,r=Object(V.a)(this.rules[e.symbol.symbol]);try{for(r.s();!(a=r.n()).done;){var i=a.value;n[t].add(new U(e.symbol,[],i[0],i.slice(1),t))}}catch(s){r.e(s)}finally{r.f()}}},{key:"scanner",value:function(e,t,n,a){t!==a.length&&a[t]===e.symbol.symbol[0]&&this.nextInRule(e,t+1,n)}},{key:"nextInRule",value:function(e,t,n){var a=Object(j.a)(e.before);if(e.symbol instanceof Z){var r=a.length-1;a[r]instanceof Z?a[r]=new Z(a[r].symbol+e.symbol.symbol[0]):a.push(new Z(e.symbol.symbol[0]))}else a.push(e.symbol);e.symbol instanceof Z&&e.symbol.symbol.length>1?n[t].add(new U(e.left,a,new Z(e.symbol.symbol.slice(1)),Object(j.a)(e.after),e.origin)):n[t].add(new U(e.left,a,e.after[0],e.after.slice(1),e.origin))}}]),e}()),H=n(121),X=n.n(H),ee=function(e){var t=e.id,n=e.className,a=e.title,r=e.placeholder,i=e.onChange,s=e.value,c=e.aria,o=e.children,l=t||X()();return Object(N.jsxs)("div",{className:"".concat(k.a.area," ").concat(n||""),children:[a&&Object(N.jsx)("h2",{className:k.a.title,children:Object(N.jsx)("label",{htmlFor:l,children:a})}),Object(N.jsx)("textarea",{id:l,className:"textarea monospace",onChange:i,draggable:"false",placeholder:"string"===typeof r?r:"Enter text here...",value:s,"aria-label":c}),o&&Object(N.jsx)("div",{className:"children",children:o})]})},te=function(e){var t=e.className,n=m.useContainer(),a=n.rules,r=n.setRules,s=n.setGrammar,c=Object(i.useState)(["",""]),o=Object(u.a)(c,2),l=o[0],h=o[1],b=Object(i.useRef)(0),f=Object(i.useCallback)((function(){return b.current=window.setTimeout((function(){try{s(new K(a)),h(["ok",""])}catch(e){h(["error","".concat(e)])}}),50),function(){return window.clearTimeout(b.current)}}),[a,s]);return Object(i.useEffect)(f,[a,f]),Object(N.jsx)("div",{className:"".concat(t||""," status-").concat(l[0]," App-bodyComponent"),children:Object(N.jsxs)(ee,{className:y.a.textarea,value:a,onChange:function(e){e.target&&r(e.target.value)},title:"Rules",aria:"Rules that describe the grammar",placeholder:"Enter rules here... e.g.\nS -> 1 | 2 | 3\nS -> 4 | 5 | 6",children:[Object(N.jsx)("div",{className:"row1",children:Object(N.jsx)("div",{className:"status",children:l[1]})}),Object(N.jsx)("div",{className:"row2",children:Object(N.jsx)("button",{className:"button secondary",onClick:function(e){e.target&&(e.target.blur(),f())},children:"Regenerate Model"})})]})})},ne=function(e){var t=e.className,n=m.useContainer(),a=n.input,r=n.setInput,s=n.grammar,c=Object(i.useState)(["",""]),o=Object(u.a)(c,2),l=o[0],h=o[1],b=Object(i.useState)(!1),f=Object(u.a)(b,2),d=f[0],v=f[1],j=Object(i.useRef)(0),p=Object(i.useCallback)((function(){try{if(!s)throw new Error("No grammar object available");s.checkValid();var e=s.matches(a);v(!1),h([e?"ok":"error","Input ".concat(e?"matches":"doesn't match")])}catch(t){v(!0),h(["error","".concat(t)])}}),[a,s]);return Object(i.useEffect)((function(){return j.current=window.setTimeout(p,100),function(){return window.clearTimeout(j.current)}}),[p]),Object(N.jsx)("div",{className:"".concat(t||""," status-").concat(l[0]," App-bodyComponent"),children:Object(N.jsxs)(ee,{className:y.a.textarea,value:a,onChange:function(e){e.target&&r(e.target.value)},title:"Test Input",aria:"Input to match with grammar",children:[Object(N.jsx)("div",{className:"row1",children:Object(N.jsx)("span",{className:"status",children:l[1]})}),Object(N.jsx)("div",{className:"row2",children:Object(N.jsx)("button",{className:"button secondary",onClick:function(e){e.target&&(e.target.blur(),p())},disabled:d,children:"Re-Match"})})]})})},ae=function(e){var t=e.className;return Object(N.jsx)("div",{className:"".concat(t||""," ").concat(v.a.grid," App-body"),children:Object(N.jsxs)(m.Provider,{initialState:window.location.hash,children:[Object(N.jsx)(te,{className:v.a.left}),Object(N.jsx)(ne,{className:v.a.rightTop}),Object(N.jsx)(_,{className:v.a.rightBottom})]})})},re=function(e){var t=e.className,n=(new Date).getFullYear().toString(),a="2020",r="Constantin Piber",i="https://github.com/cpiber/cfg-tester";return Object(N.jsxs)("footer",{className:"".concat(t||""," App-footer"),children:[n===a?n:"".concat(a,"-").concat(n)," by ".concat(r),Object(N.jsxs)(s.a.Fragment,{children:[Object(N.jsx)("span",{children:" :: "}),Object(N.jsx)("a",{href:i,target:"_blank",rel:"noopener noreferrer",children:"Source"})]})]})},ie=function(e){var t=e.className;return Object(N.jsx)("header",{className:"".concat(t||""," App-header"),children:Object(N.jsxs)("h1",{children:[Object(N.jsx)("abbr",{title:"Context-free grammar",children:"CFG"})," Testing suite"]})})},se=function(){return Object(N.jsxs)("div",{className:"App",children:[Object(N.jsx)(ie,{}),Object(N.jsx)(ae,{}),Object(N.jsx)(re,{})]})};n(227),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(N.jsx)(se,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},25:function(e,t,n){e.exports={textarea:"bodyComponent_textarea__2AEVB"}},26:function(e,t,n){e.exports={area:"textarea_area__1mQmu",title:"textarea_title__3f-Ka"}},38:function(e,t,n){e.exports={grid:"Body_grid__2Eze4",left:"Body_left__3afN_",rightTop:"Body_rightTop__x95CP",rightBottom:"Body_rightBottom__2q8gj"}},68:function(e,t,n){e.exports={strings:"GrammarOutput_strings__syveZ",empty:"GrammarOutput_empty__3tYL_"}}},[[228,1,2]]]);
//# sourceMappingURL=main.158898f2.chunk.js.map